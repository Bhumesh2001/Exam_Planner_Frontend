{% extends "base.html" %} {% block title %}Reminders — Exam Planner{% endblock
%} {% block content %}

<div class="w-full px-8 py-6">
  <header
    class="flex justify-between items-center mb-8 border-b border-gray-700 pb-4"
  >
    <h2 class="text-3xl font-bold text-white">Reminders</h2>
    <div class="flex items-center gap-4">
      <a
        href="{{ url_for('dashboard') }}"
        class="text-gray-300 hover:text-blue-400 transition"
        >Back</a
      >
      <button
        id="openReminderModal"
        class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-white font-medium transition"
      >
        + Add Reminder
      </button>
    </div>
  </header>

  <!-- All Reminders Section -->
  <section
    class="bg-gray-900/70 backdrop-blur-md border border-gray-700 rounded-2xl shadow-xl p-8"
  >
    <h3 class="text-2xl font-semibold mb-6 text-white">All Reminders</h3>
    {% if reminders %}
    <ul class="divide-y divide-gray-700">
      {% for r in reminders %}
      <li
        class="py-4 flex justify-between items-center hover:bg-gray-800/40 rounded-lg px-3 transition"
      >
        <div>
          <div class="font-semibold text-gray-100">{{ r.message }}</div>
          <div class="text-gray-400 text-sm">
            {{ (r.remindAt|replace('T',' ')|replace('Z','')) }}
          </div>
        </div>
        <form action="{{ url_for('delete_reminder', id=r._id) }}" method="post">
          <button
            class="px-3 py-1 bg-red-600 hover:bg-red-700 rounded-lg text-white transition"
          >
            Delete
          </button>
        </form>
      </li>
      {% endfor %}
    </ul>
    {% else %}
    <p class="text-gray-400">No reminders found.</p>
    {% endif %}
  </section>
</div>

<!-- Add Reminder Modal -->
<div
  id="reminderModal"
  class="fixed inset-0 hidden items-center justify-center bg-black/60 z-50"
>
  <div
    class="bg-gray-900 border border-gray-700 rounded-2xl shadow-2xl p-8 w-full max-w-lg relative"
  >
    <button
      id="closeReminderModal"
      class="absolute top-4 right-4 text-gray-400 hover:text-gray-200 text-xl"
    >
      ✕
    </button>
    <h3 class="text-2xl font-semibold mb-6 text-white">Add New Reminder</h3>

    <form method="post" class="grid gap-4">
      <input
        name="message"
        placeholder="Reminder message"
        class="px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white"
      />
      <input
        name="remindAt"
        type="datetime-local"
        class="px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white"
      />
      <select
        name="examId"
        class="px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white"
      >
        <option value="">Select Exam for Reminder</option>
        {% for exam in exams %}
        <option value="{{ exam._id }}">
          {{ exam.title }} — {{ exam.subject }}
        </option>
        {% endfor %}
      </select>

      <button
        type="submit"
        class="w-full py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-white font-medium transition"
      >
        Save Reminder
      </button>
    </form>
  </div>
</div>

<script>
  const reminderModal = document.getElementById("reminderModal");
  const openReminderModal = document.getElementById("openReminderModal");
  const closeReminderModal = document.getElementById("closeReminderModal");

  openReminderModal.addEventListener("click", () => {
    reminderModal.classList.remove("hidden");
    reminderModal.classList.add("flex");
  });

  closeReminderModal.addEventListener("click", () => {
    reminderModal.classList.remove("flex");
    reminderModal.classList.add("hidden");
  });

  // Close modal on outside click
  reminderModal.addEventListener("click", (e) => {
    if (e.target === reminderModal) {
      reminderModal.classList.remove("flex");
      reminderModal.classList.add("hidden");
    }
  });
</script>

{% endblock %}
